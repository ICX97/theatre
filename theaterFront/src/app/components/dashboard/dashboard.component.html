<div class="dashboard-container">
    <!-- Add News Section -->
    <div class="news-section">
        <h2>Add News</h2>
        <div class="news-card">
            <form (ngSubmit)="addNews()" class="news-form">
                <div class="form-left-column">
                    <div class="form-group">
                        <label for="newsTitle">News Title</label>
                        <input type="text" id="newsTitle" [(ngModel)]="news.newsTitle" name="newsTitle" required placeholder="Enter news title">
                    </div>
                    
                    <div class="form-group">
                        <label for="newsDescription">News Description</label>
                        <textarea id="newsDescription" [(ngModel)]="news.newsDescription" name="newsDescription" placeholder="Enter news description" rows="4"></textarea>
                    </div>
                </div>
                
                <div class="form-right-column">
                    <div class="form-group">
                        <label for="newsDate">News Date</label>
                        <input type="date" id="newsDate" [(ngModel)]="news.newsDate" name="newsDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="newsImage">Upload Image (optional)</label>
                        <div class="file-upload-container">
                            <input type="file" id="newsImage" (change)="onFileSelectNews($event)" name="newsImage" accept="image/*">
                            <div class="file-upload-label">
                                <i class="upload-icon">üì∑</i>
                                <span>{{ selectedNewsImage ? 'Imported: ' + selectedNewsImage : 'Choose image' }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="add-news-btn">
                        <i class="btn-icon">üì∞</i>
                        Add News
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- News Management Section (Admin only) -->
    <div class="news-management-section">
        <div class="section-header">
            <button type="button" class="dropdown-toggle" (click)="toggleNewsManagement()">
                <span class="section-title">Manage News</span>
                <i class="dropdown-arrow" [class.rotated]="showNewsManagement">‚ñº</i>
            </button>
        </div>
        
        <!-- News List with Pagination -->
        <div class="news-list" [class.collapsed]="!showNewsManagement">
            <div *ngFor="let news of paginatedNews" class="news-item">
                <div class="news-content">
                    <h4>{{ news.newsTitle }}</h4>
                    <p class="news-date">{{ news.newsDate | date:'yyyy-MM-dd' }}</p>
                    <p class="news-description">{{ news.newsDescription }}</p>
                </div>
                <div class="news-actions">
                    <button type="button" class="edit-btn" (click)="openEditNewsModal(news)">
                        <i class="btn-icon">‚úèÔ∏è</i>
                        Edit
                    </button>
                    <button type="button" class="delete-btn" (click)="openDeleteNewsModal(news)">
                        <i class="btn-icon">üóëÔ∏è</i>
                        Delete
                    </button>
                </div>
            </div>
        </div>

        <!-- Pagination Controls -->
        <div *ngIf="totalPages > 1" class="pagination-container" [class.collapsed]="!showNewsManagement">
            <div class="pagination-controls">
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasPreviousPage"
                        (click)="previousPage()">
                    <i class="btn-icon">‚Üê</i>
                    Previous
                </button>
                
                <div class="page-numbers">
                    <button *ngFor="let page of getPageNumbers()" 
                            type="button"
                            class="page-number-btn"
                            [class.active]="page === currentPage"
                            (click)="goToPage(page)">
                        {{ page }}
                    </button>
                </div>
                
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasNextPage"
                        (click)="nextPage()">
                    Next
                    <i class="btn-icon">‚Üí</i>
                </button>
            </div>
        </div>
    </div>

    <!-- News Modal Component -->
    <app-news-modal
        [isVisible]="showEditNewsModal"
        [news]="editNews"
        [mode]="modalMode"
        (close)="closeEditModals()"
        (save)="onNewsSave($event)"
        (delete)="onNewsDelete($event)">
    </app-news-modal>

    <!-- Actor Modal Component -->
    <app-actor-modal
        [isVisible]="showEditActorModal"
        [actor]="editActor"
        [mode]="modalMode"
        (close)="closeEditModals()"
        (save)="onActorSave($event)"
        (delete)="onActorDelete($event)">
    </app-actor-modal>

    <!-- Performance Modal Component -->
    <app-performance-modal
        [isVisible]="showEditPerformanceModal"
        [performance]="editPerformance"
        [mode]="modalMode"
        (close)="closeEditModals()"
        (save)="onPerformanceSave($event)"
        (delete)="onPerformanceDelete($event)">
    </app-performance-modal>

    <!-- Add Performance Section -->
    <div class="performance-section">
        <h2>Add Performance</h2>
        <div class="performance-card">
            <form (ngSubmit)="addPerformance()" class="performance-form">
                <!-- Prvi red: Title, Date, Hall Selection -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="performanceTitle">Performance Title</label>
                        <input type="text" id="performanceTitle" [(ngModel)]="performance.performance_title" name="performanceTitle" required placeholder="Enter performance title">
                    </div>
                    
                    <div class="form-group">
                        <label for="performanceDate">Performance Date</label>
                        <input type="date" id="performanceDate" [(ngModel)]="performance.performance_date" name="performanceDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Select Hall</label>
                        <div class="hall-options">
                            <label class="hall-option">
                                <input type="radio" [(ngModel)]="performance.hallId" name="hallId" [value]="1" required>
                                <span class="hall-label">Hall 1</span>
                            </label>
                            <label class="hall-option">
                                <input type="radio" [(ngModel)]="performance.hallId" name="hallId" [value]="2" required>
                                <span class="hall-label">Hall 2</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Drugi red: Ticket Prices -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="parterPrice">Parter Price</label>
                        <input type="number" id="parterPrice" [(ngModel)]="parterPrice" name="parterPrice" placeholder="Enter parter ticket price">
                    </div>
                    
                    <div class="form-group">
                        <label for="balkonPrice">Balkon Price</label>
                        <input type="number" id="balkonPrice" [(ngModel)]="balkonPrice" name="balkonPrice" placeholder="Enter balkon ticket price">
                    </div>
                    
                    <div class="form-group">
                        <label for="lozaPrice">Lo≈æa Price</label>
                        <input type="number" id="lozaPrice" [(ngModel)]="lozaPrice" name="lozaPrice" placeholder="Enter lo≈æa ticket price">
                    </div>
                </div>

                <!-- Treƒái red: Adaptation, Dramaturg, Scenographer, Costume Designer -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="adaptation">Adaptation</label>
                        <input type="text" id="adaptation" [(ngModel)]="performance.adaptation" name="adaptation" placeholder="Enter adaptation details">
                    </div>
                    
                    <div class="form-group">
                        <label for="dramaturg">Dramaturg</label>
                        <input type="text" id="dramaturg" [(ngModel)]="performance.dramaturg" name="dramaturg" placeholder="Enter dramaturg name">
                    </div>
                    
                    <div class="form-group">
                        <label for="scenographer">Scenographer</label>
                        <input type="text" id="scenographer" [(ngModel)]="performance.scenographer" name="scenographer" placeholder="Enter scenographer name">
                    </div>
                    
                    <div class="form-group">
                        <label for="costumeDesigner">Costume Designer</label>
                        <input type="text" id="costumeDesigner" [(ngModel)]="performance.costumeDesigner" name="costumeDesigner" placeholder="Enter costume designer name">
                    </div>
                </div>

                <!-- ƒåetvrti red: Director, Music, Stage Speech, Stage Manager -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="director">Director</label>
                        <input type="text" id="director" [(ngModel)]="performance.director" name="director" placeholder="Enter director name">
                    </div>
                    
                    <div class="form-group">
                        <label for="music">Music</label>
                        <input type="text" id="music" [(ngModel)]="performance.music" name="music" placeholder="Enter music details">
                    </div>
                    
                    <div class="form-group">
                        <label for="stageSpeech">Stage Speech</label>
                        <input type="text" id="stageSpeech" [(ngModel)]="performance.stageSpeech" name="stageSpeech" placeholder="Enter stage speech details">
                    </div>
                    
                    <div class="form-group">
                        <label for="stageManager">Stage Manager</label>
                        <input type="text" id="stageManager" [(ngModel)]="performance.stageManager" name="stageManager" placeholder="Enter stage manager name">
                    </div>
                </div>

                <!-- Peti red: Description, Upload Image, Select Actors -->
                <div class="form-row description-upload-row">
                    <div class="form-group description-group">
                        <label for="performanceDescription">Performance Description</label>
                        <textarea id="performanceDescription" [(ngModel)]="performance.performance_description" name="performanceDescription" placeholder="Enter performance description" rows="6"></textarea>
                    </div>
                    
                    <div class="form-group upload-actors-group">
                        <div class="upload-section">
                            <label for="poster_image">Upload Image (optional)</label>
                            <div class="file-upload-container">
                                <input type="file" id="poster_image" (change)="onFileSelectPerformance($event)" name="poster_image" accept="image/*">
                                <div class="file-upload-label">
                                    <i class="upload-icon">üé≠</i>
                                    <span>{{ selectedPerformanceImage ? 'Imported: ' + selectedPerformanceImage : 'Choose poster' }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="actors-section">
                            <label>Select Actors</label>
                            <p-multiSelect
                              class="custom-multiselect"
                              [options]="actorsList"
                              [(ngModel)]="selectedActors"
                              optionLabel="label"
                              optionValue="value"
                              placeholder=" ">
                            </p-multiSelect>
                        </div>
                    </div>
                </div>

                <input type="hidden" [(ngModel)]="performance.created_at" name="created_at">
                <input type="hidden" [(ngModel)]="performance.updated_at" name="updated_at">
                
                <div class="form-actions">
                    <button type="submit" class="add-performance-btn" [disabled]="isCreatingPerformance">
                        <div *ngIf="isCreatingPerformance" class="spinner"></div>
                        <i *ngIf="!isCreatingPerformance" class="btn-icon">üé¨</i>
                        {{ isCreatingPerformance ? 'Creating...' : 'Add Performance' }}
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Performance Management Section (Admin only) -->
    <div class="performance-management-section">
        <div class="section-header">
            <button type="button" class="dropdown-toggle" (click)="togglePerformanceManagement()">
                <span class="section-title">Manage Performances</span>
                <i class="dropdown-arrow" [class.rotated]="showPerformanceManagement">‚ñº</i>
            </button>
        </div>
        
        <!-- Performance List with Pagination -->
        <div class="performance-list" [class.collapsed]="!showPerformanceManagement">
            <div *ngFor="let performance of paginatedPerformances" class="performance-item">
                <div class="performance-content">
                    <h4>{{ performance.performance_title }}</h4>
                    <p class="performance-date">Date: {{ performance.performance_date | date:'yyyy-MM-dd' }}</p>
                    <p class="performance-hall">Hall: {{ performance.hallId }}</p>
                    <p class="performance-actors" *ngIf="performance.actors && performance.actors.length > 0">
                        Actors: {{ getActorsNames(performance.actors) }}
                    </p>
                    <p class="performance-ticket-prices" *ngIf="performance.ticketPrices && performance.ticketPrices.length > 0">
                        Ticket Prices: {{ getTicketPricesInfo(performance.ticketPrices) }}
                    </p>
                </div>
                <div class="performance-actions">
                    <button type="button" class="edit-btn" (click)="openEditPerformanceModal(performance)">
                        <i class="btn-icon">‚úèÔ∏è</i>
                        Edit
                    </button>
                    <button type="button" class="delete-btn" (click)="openDeletePerformanceModal(performance)">
                        <i class="btn-icon">üóëÔ∏è</i>
                        Delete
                    </button>
                </div>
            </div>
        </div>

        <!-- Pagination Controls -->
        <div *ngIf="totalPerformancePages > 1" class="pagination-container" [class.collapsed]="!showPerformanceManagement">
            <div class="pagination-controls">
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasPreviousPerformancePage"
                        (click)="previousPerformancePage()">
                    <i class="btn-icon">‚Üê</i>
                    Previous
                </button>
                
                <div class="page-numbers">
                    <button *ngFor="let page of getPerformancePageNumbers()" 
                            type="button"
                            class="page-number-btn"
                            [class.active]="page === currentPerformancePage"
                            (click)="goToPerformancePage(page)">
                        {{ page }}
                    </button>
                </div>
                
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasNextPerformancePage"
                        (click)="nextPerformancePage()">
                    Next
                    <i class="btn-icon">‚Üí</i>
                </button>
            </div>
        </div>
    </div>

    <!-- Add Actor Section -->
    <div class="actor-section">
        <h2>Add Actor</h2>
        <div class="actor-card">
            <form (ngSubmit)="addActor()" class="actor-form">
                <!-- Prvi red: First Name, Last Name, Birth Year -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" id="firstName" [(ngModel)]="ensemble.firstName" name="firstName" required placeholder="Enter first name">
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" id="lastName" [(ngModel)]="ensemble.lastName" name="lastName" required placeholder="Enter last name">
                    </div>
                    
                    <div class="form-group">
                        <label for="birthYear">Birth Year (optional)</label>
                        <input type="number" id="birthYear" [(ngModel)]="ensemble.birthYear" name="birthYear" placeholder="Enter birth year">
                    </div>
                </div>

                <!-- Drugi red: Description -->
                <div class="form-row">
                    <div class="form-group description-group">
                        <label for="ensembleDescription">Description</label>
                        <textarea id="ensembleDescription" [(ngModel)]="ensemble.ensemble_description" name="ensembleDescription" placeholder="Enter description" rows="4"></textarea>
                    </div>
                </div>

                <!-- Treƒái red: Upload Image -->
                <div class="form-row">
                    <div class="form-group">
                        <label for="actorImage">Upload Actor Image (optional)</label>
                        <div class="file-upload-container">
                            <input type="file" id="actorImage" (change)="onFileSelectActor($event)" name="actorImage" accept="image/*">
                            <div class="file-upload-label">
                                <i class="upload-icon">üë§</i>
                                <span>{{ selectedActorImage ? 'Imported: ' + selectedActorImage : 'Choose actor image' }}</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="add-actor-btn">
                        <i class="btn-icon">üé≠</i>
                        Add Actor
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Actor Management Section (Admin only) -->
    <div class="actor-management-section">
        <div class="section-header">
            <button type="button" class="dropdown-toggle" (click)="toggleActorManagement()">
                <span class="section-title">Manage Actors</span>
                <i class="dropdown-arrow" [class.rotated]="showActorManagement">‚ñº</i>
            </button>
        </div>
        
        <!-- Actor List with Pagination -->
        <div class="actor-list" [class.collapsed]="!showActorManagement">
            <div *ngFor="let actor of paginatedActors" class="actor-item">
                <div class="actor-content">
                    <h4>{{ actor.firstName }} {{ actor.lastName }}</h4>
                    <p class="actor-birth-year" *ngIf="actor.birthYear">Born: {{ actor.birthYear }}</p>
                    <p class="actor-description">{{ actor.ensemble_description }}</p>
                </div>
                <div class="actor-actions">
                    <button type="button" class="edit-btn" (click)="openEditActorModal(actor)">
                        <i class="btn-icon">‚úèÔ∏è</i>
                        Edit
                    </button>
                    <button type="button" class="delete-btn" (click)="openDeleteActorModal(actor)">
                        <i class="btn-icon">üóëÔ∏è</i>
                        Delete
                    </button>
                </div>
            </div>
        </div>

        <!-- Pagination Controls -->
        <div *ngIf="totalActorPages > 1" class="pagination-container" [class.collapsed]="!showActorManagement">
            <div class="pagination-controls">
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasPreviousActorPage"
                        (click)="previousActorPage()">
                    <i class="btn-icon">‚Üê</i>
                    Previous
                </button>
                
                <div class="page-numbers">
                    <button *ngFor="let page of getActorPageNumbers()" 
                            type="button"
                            class="page-number-btn"
                            [class.active]="page === currentActorPage"
                            (click)="goToActorPage(page)">
                        {{ page }}
                    </button>
                </div>
                
                <button type="button" 
                        class="pagination-btn" 
                        [disabled]="!hasNextActorPage"
                        (click)="nextActorPage()">
                    Next
                    <i class="btn-icon">‚Üí</i>
                </button>
            </div>
        </div>
    </div>
</div>
